import{$ as s,S as t,R as i,aw as a}from"./chunks/framework.CL7hJqEm.js";const b=JSON.parse('{"title":"pandas1","titleTemplate":"Python笔记","description":"","frontmatter":{"title":"pandas1","titleTemplate":"Python笔记"},"headers":[],"relativePath":"pages/python/basic/science-compute/pandas1.md","filePath":"pages/python/basic/science-compute/pandas1.md","lastUpdated":null}'),n={name:"pages/python/basic/science-compute/pandas1.md"},h=a(`<div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#每个cell多个输出</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IPython.core.interactiveshell </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> InteractiveShell</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InteractiveShell.ast_node_interactivity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;all&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#查看版本</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__version__</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><pre><code>&#39;1.5.3&#39;
</code></pre><h2 id="_1-series-一维" tabindex="-1">1. Series 一维 <a class="header-anchor" href="#_1-series-一维" aria-label="Permalink to &quot;1. Series 一维&quot;">​</a></h2><p>（1）由列表生成 Series：<b>s=pd.Series([],index=)</b>，可指定索引，这样即能用原来的 0-len(s)也能用自定义的索引 <br>   由字典生成 Series：<b>s=pd.Series({&#39;python&#39;:150,&#39;numpy&#39;:100,&#39;pandas&#39;:130})</b><br>   <b>s.index</b>查看索引 <br>   <b>s.values</b>查看值 <br>   <b>s.size</b>查看元素个数 <br>   <b>len(s)</b>查看长度 <br>   <b>s.isnull()、pd.isnull(s)</b>判断是否为空，<b>s.notnull()</b>判断是否不为空，返回判断布尔类型结果 <br>   <b>s.fillna()</b>，填充缺失值，不会改变原数据，指定 inplace=True 则会改变原数据 <br>   <b>s.dropna()</b>，删除缺失值，不会改变原数据，指定 inplace=True 则会改变原数据 <br>   <b>s.get(&#39;f&#39;,100)</b>，判断索引 f 是否在 s 中，如果在则返回对应值，不在则返回指定值（如 100）</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,np.nan,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;qwe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;我&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;e&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;python&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;numpy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pandas&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">130</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.index</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.size</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><pre><code>a      1
b      3
c      5
d    NaN
e      6
f    qwe
g      我
dtype: object

python    150
numpy     100
pandas    130
dtype: int64

Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;], dtype=&#39;object&#39;)

array([1, 3, 5, nan, 6, &#39;qwe&#39;, &#39;我&#39;], dtype=object)

7

7
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,np.nan,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;qwe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;我&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;e&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.isnull()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.isnull(s)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#保留非空，~取反</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.isnull()]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[s.notnull()]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[pd.notnull(s)]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><pre><code>a    False
b    False
c    False
d     True
e    False
f    False
g    False
dtype: bool

a    False
b    False
c    False
d     True
e    False
f    False
g    False
dtype: bool

a      1
b      3
c      5
e      6
f    qwe
g      我
dtype: object

a      1
b      3
c      5
e      6
f    qwe
g      我
dtype: object

a      1
b      3
c      5
e      6
f    qwe
g      我
dtype: object
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,np.nan,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;qwe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;我&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;e&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.get(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;不在&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;h&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;不在&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.fillna(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.dropna(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inplace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#这句没有输出</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><pre><code>&#39;qwe&#39;

&#39;不在&#39;

a       1
b       3
c       5
d    9990
e       6
f     qwe
g       我
dtype: object

a      1
b      3
c      5
d    NaN
e      6
f    qwe
g      我
dtype: object

a      1
b      3
c      5
e      6
f    qwe
g      我
dtype: object
</code></pre><p>（2）<b>s[3]</b>查看索引为 3 的元素 <br>   <b>s[&#39;a&#39;]</b>查看索引为 a 的元素 <br>   索引、切片类似于数组，用默认索引左闭右开，用自定义索引左闭右闭</p><p>   索引名称赋值，<b>s.index.name=&#39;索引&#39;</b><br>   改变自定义索引，<b>s.index=list(&#39;ABCDEFG&#39;)</b><br>   <b>s.loc[]</b>，可以用默认索引和自定义索引取元素，多行写成列表形式 <br>   <b>s.iloc</b></p><p>   可以取一个、连续多个、间隔取值、不规则间隔取值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,np.nan,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;qwe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;我&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;e&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;python&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.loc[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;python&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.loc[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;python&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;numpy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.iloc[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><pre><code>1

a    1
dtype: object

&#39;qwe&#39;

a    1
c    5
e    6
g    我
dtype: object

b      3
d    NaN
dtype: object

a      1
d    NaN
dtype: object

a    1
b    3
c    5
dtype: object

150

python    150
dtype: int64

python    150
numpy     100
dtype: int64

100

python    150
numpy     100
dtype: int64

python    150
pandas    130
dtype: int64
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,np.nan,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;qwe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;我&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;c&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;e&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.index.name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;索引&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ABCDEFG&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><pre><code>索引
a      1
b      3
c      5
d    NaN
e      6
f    qwe
g      我
dtype: object

A      1
B      3
C      5
D    NaN
E      6
F    qwe
G      我
dtype: object
</code></pre><p>（3）基本算术运算，加减乘除、取余数、幂运算、求商等 <br>   Series 之间的运算，加减，<b>根据索引对应计算，如果长度不同则多出的结果是 NaN</b></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.add(s2,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fill_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#先把的部分用10填充，再和s2相加，s1、s2顺序没关系</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><pre><code>0    1
1    2
2    3
dtype: int64

2    1
1    2
0    3
3    4
dtype: int64

0    4.0
1    4.0
2    4.0
3    NaN
dtype: float64

0     4.0
1     4.0
2     4.0
3    14.0
dtype: float64
</code></pre><h2 id="_2-dataframe" tabindex="-1">2. DataFrame <a class="header-anchor" href="#_2-dataframe" aria-label="Permalink to &quot;2. DataFrame&quot;">​</a></h2><h3 id="_1-pd-date-range" tabindex="-1">1. pd.date_range() <a class="header-anchor" href="#_1-pd-date-range" aria-label="Permalink to &quot;1. pd.date_range()&quot;">​</a></h3><ul><li>参数有开始、截止日期、时间数 <br>   不指定时间数则生成整天，如果指定了时间数（但按整天算数量不符合）会每天再分小时 <br>   也可以只指定开始日期和时间数，或者截止日期和时间数，这两个都默认整天</li></ul><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.date_range(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;20230610&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;20230520&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">periods</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><pre><code>DatetimeIndex([          &#39;2023-06-10 00:00:00&#39;,
               &#39;2023-06-08 02:10:54.545454545&#39;,
               &#39;2023-06-06 04:21:49.090909090&#39;,
               &#39;2023-06-04 06:32:43.636363636&#39;,
               &#39;2023-06-02 08:43:38.181818181&#39;,
               &#39;2023-05-31 10:54:32.727272727&#39;,
               &#39;2023-05-29 13:05:27.272727272&#39;,
               &#39;2023-05-27 15:16:21.818181818&#39;,
               &#39;2023-05-25 17:27:16.363636363&#39;,
               &#39;2023-05-23 19:38:10.909090909&#39;,
               &#39;2023-05-21 21:49:05.454545454&#39;,
                         &#39;2023-05-20 00:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.date_range(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;20230610&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">periods</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><pre><code>DatetimeIndex([&#39;2023-06-10&#39;, &#39;2023-06-11&#39;, &#39;2023-06-12&#39;, &#39;2023-06-13&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.date_range(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;20230520&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">periods</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><pre><code>DatetimeIndex([&#39;2023-05-15&#39;, &#39;2023-05-16&#39;, &#39;2023-05-17&#39;, &#39;2023-05-18&#39;,
               &#39;2023-05-19&#39;, &#39;2023-05-20&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</code></pre><h3 id="_2-构造-dataframe-要求每列数据类型一致-不同列不要求" tabindex="-1">2. 构造 DataFrame，要求每列数据类型一致，不同列不要求 <a class="header-anchor" href="#_2-构造-dataframe-要求每列数据类型一致-不同列不要求" aria-label="Permalink to &quot;2. 构造 DataFrame，要求每列数据类型一致，不同列不要求&quot;">​</a></h3><p><br>   根据二维数组构造，指定 index 表示每行索引，columns 表示每列名字，可以在构造时指定，也可以在之后获取和修改</p><p>   根据字典构造</p><p>   <b>df.head()</b>，查看前几行，不指定行数默认查看前五行 <br>   <b>df.tail()</b>，查看后几行，不指定行数默认查看后五行 <br>   <b>df.index</b>，查看索引，可修改 <br>   <b>df.columns</b>，查看列标，可修改 <br>   <b>df.values</b>，查看数据 <br>   <b>df.dtypes</b>，查看每列类型</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.date_range(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;20230610&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">periods</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.DataFrame(np.random.randn(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">date,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ABCD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.index</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;测&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;绘&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;工&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;程&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><th>2023-06-10</th><td>0.101647</td><td>-0.076880</td><td>-0.817356</td><td>-1.334510</td></tr><tr><th>2023-06-11</th><td>0.041290</td><td>-0.956650</td><td>0.326339</td><td>0.454456</td></tr><tr><th>2023-06-12</th><td>1.962830</td><td>1.817749</td><td>0.817302</td><td>0.435682</td></tr><tr><th>2023-06-13</th><td>-0.750204</td><td>-1.152845</td><td>-0.496289</td><td>0.372312</td></tr><tr><th>2023-06-14</th><td>0.718989</td><td>-0.414434</td><td>1.052482</td><td>-0.467115</td></tr><tr><th>2023-06-15</th><td>0.539968</td><td>-1.205937</td><td>-0.090362</td><td>0.283266</td></tr></tbody></table></div><pre><code>DatetimeIndex([&#39;2023-06-10&#39;, &#39;2023-06-11&#39;, &#39;2023-06-12&#39;, &#39;2023-06-13&#39;,
               &#39;2023-06-14&#39;, &#39;2023-06-15&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</code></pre><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>测</th><th>绘</th><th>工</th><th>程</th></tr></thead><tbody><tr><th>2023-06-10</th><td>0.101647</td><td>-0.076880</td><td>-0.817356</td><td>-1.334510</td></tr><tr><th>2023-06-11</th><td>0.041290</td><td>-0.956650</td><td>0.326339</td><td>0.454456</td></tr><tr><th>2023-06-12</th><td>1.962830</td><td>1.817749</td><td>0.817302</td><td>0.435682</td></tr><tr><th>2023-06-13</th><td>-0.750204</td><td>-1.152845</td><td>-0.496289</td><td>0.372312</td></tr><tr><th>2023-06-14</th><td>0.718989</td><td>-0.414434</td><td>1.052482</td><td>-0.467115</td></tr><tr><th>2023-06-15</th><td>0.539968</td><td>-1.205937</td><td>-0.090362</td><td>0.283266</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:pd.Timestamp(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;20181001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),\\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:pd.Series (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dtype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),\\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;D&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:np.array([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dtype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),\\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;E&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:pd.Categorical ([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;train&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;train&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),\\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;F&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>2018-10-01</td><td>1.0</td><td>3</td><td>test</td><td>abc</td></tr><tr><th>1</th><td>1.0</td><td>2018-10-01</td><td>1.0</td><td>3</td><td>train</td><td>abc</td></tr><tr><th>2</th><td>1.0</td><td>2018-10-01</td><td>1.0</td><td>3</td><td>test</td><td>abc</td></tr><tr><th>3</th><td>1.0</td><td>2018-10-01</td><td>1.0</td><td>3</td><td>train</td><td>abc</td></tr></tbody></table></div><h3 id="_3-读取数据及操作" tabindex="-1">3. 读取数据及操作 <a class="header-anchor" href="#_3-读取数据及操作" aria-label="Permalink to &quot;3. 读取数据及操作&quot;">​</a></h3><p><br>   <b>df[:5]、df.head()</b>返回前五行 <br>   <b>df[-5:]、df.tail()</b>返回后五行 <br>   <b>df.loc[0]、df.loc[1:6]、df.loc[[1,3,6]]</b>，返回对应行，左闭右闭 <br>   <b>df.iloc[0]、df.iloc[1:6]、df.iloc[[1,3,6]]</b>，返回对应行，左闭右开 <br>   <b>df.评分、df[&#39;评分&#39;]、df[[&#39;评分&#39;,&#39;产地&#39;]]</b>，查找对应一列或多列，前两个等价 <br>   <b>df[[&#39;评分&#39;,&#39;产地&#39;]][:5]</b>，先找评分产地列，再取前五个，左闭右开 <br>   <b>df.loc[3:5][&#39;类型&#39;]</b>，索引为 3 到 5 的行的类型列数据 <br>   <b>df.loc[[1,5,39],[&#39;产地&#39;,&#39;评分&#39;]]、df.loc[[1,5,39]][[&#39;产地&#39;,&#39;评分&#39;]]</b>，索引为 1、5、39 行的产地和评分，行数用切片时左闭右闭</p><p>   添加和删除都不改变原 DataFrame，需要用变量接收 <br>   添加一行，构造字典，转 Series，再 append <br>   添加一列，<b>df[&#39;列名&#39;]=range(1,len(df)+1)</b>，不能用 df.列名 <br>   删除一/多行，<b>df.drop(23)、df.drop(1:3)、df.drop([1,25,84])</b>，默认 axis=0 表示对行 <br>   删除一/多列，<b>df.drop(&#39;评分&#39;,axis=1)、df.drop([&#39;评分&#39;,&#39;年代&#39;],axis=1)</b>，指定 axis=1 表示对列 <br>   删除异常数据，<b>df.drop(df[df.时长&gt;1000].index,inplace=True)</b><br>   交换两行，<b>df1.loc[0],df1.loc[1]=df1.loc[1],df1.loc[0]</b><br>   交换两列，<b>df1.评分,df1.名字=df1.名字,df1.评分、df1[&#39;评分&#39;],df1[&#39;名字&#39;]=df1[&#39;名字&#39;],df1[&#39;评分&#39;]</b></p><p>   条件选择 <br>   <b>df.评分.idxmax()、df[&#39;评分&#39;].idxmax()、df.评分.idxmin()、df[&#39;评分&#39;].idxmin</b>，返回最值索引 <br>   <b>df.产地==&#39;美国&#39;、df[&#39;产地&#39;]==&#39;美国&#39;</b>，返回判断结果，布尔类型 <br>   <b>df[df.产地==&#39;中国大陆&#39;]</b>，对判断结果索引，返回产地为中国大陆的所有行 <br>   <b>df[(df.产地==&#39;美国&#39;)|(df.产地==&#39;中国大陆&#39;)&amp;(df.评分&gt;9)].head()</b>，产地是美国或中国大陆且评分大于 9 的前五行</p><p><br>   <b>df.产地.str.contains(&#39;.<em>美国.</em>&#39;)</b>，产地包含美国的电影，用正则表达式查询 <br>   <b>df[df.产地.isin([&#39;美国&#39;,&#39;中国&#39;])]</b>，产地是中国和美国的电影 <br>   <b>df[df.评分.between(2,4)]</b>，评分在 2 到 4 之间</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#r用来忽视后面的转义符，防止路径中的\\被认为是转义符</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.read_excel(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">..</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">/data/豆瓣电影数据</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">xlsx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index_col</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df0[df0.产地.isin([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;波兰&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中国香港&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;墨西哥&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>53</th><td>大话西游之大圣娶亲 西遊記大結局之仙履奇</td><td>366223.0</td><td>喜剧/动作/爱情/奇幻/冒险</td><td>中国香港</td><td>2014-10-24 00:00:00</td><td>95</td><td>1995</td><td>9.1</td><td>中国大陆</td></tr><tr><th>92</th><td>1/2</td><td>595.0</td><td>喜剧/爱情</td><td>中国香港</td><td>1996-09-27 00:00:00</td><td>94</td><td>1996</td><td>5.8</td><td>香港</td></tr><tr><th>120</th><td>11</td><td>254.0</td><td>剧情/惊悚</td><td>波兰</td><td>2015-09-09 00:00:00</td><td>81</td><td>2015</td><td>5.7</td><td>威尼斯电影节</td></tr><tr><th>121</th><td>新扎师兄 新紮師</td><td>9348.0</td><td>动作</td><td>中国香港</td><td>2004-05-01 00:00:00</td><td>60</td><td>2004</td><td>6.5</td><td>美国</td></tr><tr><th>182</th><td>翡翠明珠</td><td>7699.0</td><td>剧情/爱情/古装</td><td>中国香港</td><td>2010-08-13 00:00:00</td><td>60</td><td>2010</td><td>5.3</td><td>美国</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>38684</th><td>深深的腥红</td><td>617.0</td><td>剧情/爱情/惊悚/犯罪</td><td>墨西哥</td><td>1996-09-09 00:00:00</td><td>111</td><td>1996</td><td>8.2</td><td>美国</td></tr><tr><th>38694</th><td>重案实录之惊天械劫案 重案實錄之驚天械劫</td><td>90.0</td><td>动作/犯罪</td><td>中国香港</td><td>1905-06-16 00:00:00</td><td>114</td><td>1994</td><td>7.3</td><td>美国</td></tr><tr><th>38700</th><td>92应召女郎 9</td><td>154.0</td><td>喜剧/爱情</td><td>中国香港</td><td>1992-12-01 00:00:00</td><td>90</td><td>1992</td><td>6.8</td><td>美国</td></tr><tr><th>38712</th><td>省港旗兵3：逃出香港 省港旗兵第</td><td>1399.0</td><td>动作</td><td>中国香港</td><td>1989-01-12 00:00:00</td><td>100</td><td>1989</td><td>6.1</td><td>香港</td></tr><tr><th>38716</th><td>华沙谍战</td><td>719.0</td><td>动作/传记/犯罪</td><td>波兰</td><td>2014-02-07 00:00:00</td><td>128</td><td>2014</td><td>7.0</td><td>波兰</td></tr></tbody></table><p>3152 rows × 9 columns</p></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 类型包含犯罪的电影</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df0[df0.类型.str.contains(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.*犯罪.*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td></tr><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>9</th><td>这个杀手不太冷</td><td>662552.0</td><td>剧情/动作/犯罪</td><td>法国</td><td>1994-09-14 00:00:00</td><td>133</td><td>1994</td><td>9.4</td><td>法国</td></tr><tr><th>26</th><td>教父</td><td>280871.0</td><td>剧情/犯罪</td><td>美国</td><td>1972-03-15 00:00:00</td><td>175</td><td>1972</td><td>9.2</td><td>纽约首映</td></tr><tr><th>39</th><td>洞</td><td>13757.0</td><td>剧情/惊悚/犯罪</td><td>法国</td><td>1960-03-18 00:00:00</td><td>132</td><td>1960</td><td>9.2</td><td>法国</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>38684</th><td>深深的腥红</td><td>617.0</td><td>剧情/爱情/惊悚/犯罪</td><td>墨西哥</td><td>1996-09-09 00:00:00</td><td>111</td><td>1996</td><td>8.2</td><td>美国</td></tr><tr><th>38694</th><td>重案实录之惊天械劫案 重案實錄之驚天械劫</td><td>90.0</td><td>动作/犯罪</td><td>中国香港</td><td>1905-06-16 00:00:00</td><td>114</td><td>1994</td><td>7.3</td><td>美国</td></tr><tr><th>38716</th><td>华沙谍战</td><td>719.0</td><td>动作/传记/犯罪</td><td>波兰</td><td>2014-02-07 00:00:00</td><td>128</td><td>2014</td><td>7.0</td><td>波兰</td></tr><tr><th>38726</th><td>零下的激情</td><td>199.0</td><td>剧情/爱情/犯罪</td><td>美国</td><td>1987-11-06 00:00:00</td><td>98</td><td>1987</td><td>7.4</td><td>美国</td></tr><tr><th>38735</th><td>血溅画屏</td><td>95.0</td><td>剧情/悬疑/犯罪/武侠/古装</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>91</td><td>1986</td><td>7.1</td><td>美国</td></tr></tbody></table><p>3656 rows × 9 columns</p></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df0.copy()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#查看信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.info()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 38738 entries, 0 to 38737
Data columns (total 9 columns):
 #   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   名字      38178 non-null  object
 1   投票人数    38738 non-null  float64
 2   类型      38738 non-null  object
 3   产地      38738 non-null  object
 4   上映时间    38736 non-null  object
 5   时长      38738 non-null  object
 6   年代      38738 non-null  object
 7   评分      38738 non-null  float64
 8   首映地点    38737 non-null  object
dtypes: float64(2), object(7)
memory usage: 3.0+ MB
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#查看统计描述</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.describe()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>投票人数</th><th>评分</th></tr></thead><tbody><tr><th>count</th><td>38738.000000</td><td>38738.000000</td></tr><tr><th>mean</th><td>6185.833702</td><td>6.935704</td></tr><tr><th>std</th><td>26143.518786</td><td>1.270101</td></tr><tr><th>min</th><td>-118.000000</td><td>2.000000</td></tr><tr><th>25%</th><td>98.000000</td><td>6.300000</td></tr><tr><th>50%</th><td>341.000000</td><td>7.100000</td></tr><tr><th>75%</th><td>1739.750000</td><td>7.800000</td></tr><tr><th>max</th><td>692795.000000</td><td>9.900000</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.tail()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>38733</th><td>神学院 S</td><td>46.0</td><td>Adult</td><td>法国</td><td>1905-06-05 00:00:00</td><td>58</td><td>1983</td><td>8.6</td><td>美国</td></tr><tr><th>38734</th><td>1935年</td><td>57.0</td><td>喜剧/歌舞</td><td>美国</td><td>1935-03-15 00:00:00</td><td>98</td><td>1935</td><td>7.6</td><td>美国</td></tr><tr><th>38735</th><td>血溅画屏</td><td>95.0</td><td>剧情/悬疑/犯罪/武侠/古装</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>91</td><td>1986</td><td>7.1</td><td>美国</td></tr><tr><th>38736</th><td>魔窟中的幻想</td><td>51.0</td><td>惊悚/恐怖/儿童</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>78</td><td>1986</td><td>8.0</td><td>美国</td></tr><tr><th>38737</th><td>列宁格勒围困之星火战役 Блокада: Фильм 2: Ленинградский ме...</td><td>32.0</td><td>剧情/战争</td><td>苏联</td><td>1905-05-30 00:00:00</td><td>97</td><td>1977</td><td>6.6</td><td>美国</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>38733</th><td>神学院 S</td><td>46.0</td><td>Adult</td><td>法国</td><td>1905-06-05 00:00:00</td><td>58</td><td>1983</td><td>8.6</td><td>美国</td></tr><tr><th>38734</th><td>1935年</td><td>57.0</td><td>喜剧/歌舞</td><td>美国</td><td>1935-03-15 00:00:00</td><td>98</td><td>1935</td><td>7.6</td><td>美国</td></tr><tr><th>38735</th><td>血溅画屏</td><td>95.0</td><td>剧情/悬疑/犯罪/武侠/古装</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>91</td><td>1986</td><td>7.1</td><td>美国</td></tr><tr><th>38736</th><td>魔窟中的幻想</td><td>51.0</td><td>惊悚/恐怖/儿童</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>78</td><td>1986</td><td>8.0</td><td>美国</td></tr><tr><th>38737</th><td>列宁格勒围困之星火战役 Блокада: Фильм 2: Ленинградский ме...</td><td>32.0</td><td>剧情/战争</td><td>苏联</td><td>1905-05-30 00:00:00</td><td>97</td><td>1977</td><td>6.6</td><td>美国</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.loc[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.iloc[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>2</th><td>美丽人生</td><td>327855.0</td><td>剧情/喜剧/爱情</td><td>意大利</td><td>1997-12-20 00:00:00</td><td>116</td><td>1997</td><td>9.5</td><td>意大利</td></tr><tr><th>3</th><td>阿甘正传</td><td>580897.0</td><td>剧情/爱情</td><td>美国</td><td>1994-06-23 00:00:00</td><td>142</td><td>1994</td><td>9.4</td><td>洛杉矶首映</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>5</th><td>泰坦尼克号</td><td>157074.0</td><td>剧情/爱情/灾难</td><td>美国</td><td>2012-04-10 00:00:00</td><td>194</td><td>2012</td><td>9.4</td><td>中国大陆</td></tr><tr><th>100</th><td>101</td><td>146.0</td><td>喜剧/爱情</td><td>韩国</td><td>1993-06-19 00:00:00</td><td>112</td><td>1993</td><td>7.4</td><td>韩国</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>2</th><td>美丽人生</td><td>327855.0</td><td>剧情/喜剧/爱情</td><td>意大利</td><td>1997-12-20 00:00:00</td><td>116</td><td>1997</td><td>9.5</td><td>意大利</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>5</th><td>泰坦尼克号</td><td>157074.0</td><td>剧情/爱情/灾难</td><td>美国</td><td>2012-04-10 00:00:00</td><td>194</td><td>2012</td><td>9.4</td><td>中国大陆</td></tr><tr><th>100</th><td>101</td><td>146.0</td><td>喜剧/爱情</td><td>韩国</td><td>1993-06-19 00:00:00</td><td>112</td><td>1993</td><td>7.4</td><td>韩国</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.评分.tail()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;产地&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]].head()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><pre><code>38733    8.6
38734    7.6
38735    7.1
38736    8.0
38737    6.6
Name: 评分, dtype: float64
</code></pre><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>评分</th><th>产地</th></tr></thead><tbody><tr><th>0</th><td>9.6</td><td>美国</td></tr><tr><th>1</th><td>9.5</td><td>美国</td></tr><tr><th>2</th><td>9.5</td><td>意大利</td></tr><tr><th>3</th><td>9.4</td><td>美国</td></tr><tr><th>4</th><td>9.4</td><td>中国大陆</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;产地&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]][:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>评分</th><th>产地</th></tr></thead><tbody><tr><th>0</th><td>9.6</td><td>美国</td></tr><tr><th>1</th><td>9.5</td><td>美国</td></tr><tr><th>2</th><td>9.5</td><td>意大利</td></tr><tr><th>3</th><td>9.4</td><td>美国</td></tr><tr><th>4</th><td>9.4</td><td>中国大陆</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;类型&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><pre><code>3       剧情/爱情
4    剧情/爱情/同性
5    剧情/爱情/灾难
Name: 类型, dtype: object
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.loc[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">39</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;产地&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.loc[[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">39</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]][[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;产地&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>产地</th><th>评分</th></tr></thead><tbody><tr><th>1</th><td>美国</td><td>9.5</td></tr><tr><th>5</th><td>美国</td><td>9.4</td></tr><tr><th>39</th><td>法国</td><td>9.2</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>产地</th><th>评分</th></tr></thead><tbody><tr><th>1</th><td>美国</td><td>9.5</td></tr><tr><th>5</th><td>美国</td><td>9.4</td></tr><tr><th>39</th><td>法国</td><td>9.2</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>产地</th><th>评分</th></tr></thead><tbody><tr><th>1</th><td>美国</td><td>9.5</td></tr><tr><th>2</th><td>意大利</td><td>9.5</td></tr><tr><th>3</th><td>美国</td><td>9.4</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#添加行删除行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.copy()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;名字&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;复仇者联盟3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;投票人数&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;123456&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;类型&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;剧情/科幻&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     &#39;产地&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;美国&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;上映时间&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;9999-99-99 99:99:99&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时长&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;999&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     &#39;年代&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;9999&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;9.9&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;首映地点&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;美国&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.Series(dit)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">38738</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#加到最后一行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.append(s)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.tail(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.tail(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.drop(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df1)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#删掉最后一行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.tail(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><pre><code>C:\\Users\\86188\\AppData\\Local\\Temp\\ipykernel_6648\\3339075158.py:7: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  df1=df1.append(s)
</code></pre><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>38736</th><td>魔窟中的幻想</td><td>51.0</td><td>惊悚/恐怖/儿童</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>78</td><td>1986</td><td>8.0</td><td>美国</td></tr><tr><th>38737</th><td>列宁格勒围困之星火战役 Блокада: Фильм 2: Ленинградский ме...</td><td>32.0</td><td>剧情/战争</td><td>苏联</td><td>1905-05-30 00:00:00</td><td>97</td><td>1977</td><td>6.6</td><td>美国</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>38737</th><td>列宁格勒围困之星火战役 Блокада: Фильм 2: Ленинградский ме...</td><td>32.0</td><td>剧情/战争</td><td>苏联</td><td>1905-05-30 00:00:00</td><td>97</td><td>1977</td><td>6.6</td><td>美国</td></tr><tr><th>38738</th><td>复仇者联盟3</td><td>123456</td><td>剧情/科幻</td><td>美国</td><td>9999-99-99 99:99:99</td><td>999</td><td>9999</td><td>9.9</td><td>美国</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>38736</th><td>魔窟中的幻想</td><td>51.0</td><td>惊悚/恐怖/儿童</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>78</td><td>1986</td><td>8.0</td><td>美国</td></tr><tr><th>38737</th><td>列宁格勒围困之星火战役 Блокада: Фильм 2: Ленинградский ме...</td><td>32.0</td><td>剧情/战争</td><td>苏联</td><td>1905-05-30 00:00:00</td><td>97</td><td>1977</td><td>6.6</td><td>美国</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#添加列删除列</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.copy()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;序号1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;序号2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.drop([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;序号1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;序号2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th><th>序号1</th><th>序号2</th></tr></thead><tbody><tr><th>0</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td><td>1</td><td>38739</td></tr><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td><td>2</td><td>38738</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td></tr><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#交换两行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.copy()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.head(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],df1.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],df1.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.head(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td></tr><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>1</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#交换两列</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.copy()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.评分,df1.名字</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.名字,df1.评分</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># df1[&#39;评分&#39;],df1[&#39;名字&#39;]=df1[&#39;名字&#39;],df1[&#39;评分&#39;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td></tr></tbody></table></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>9.6</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>肖申克的救赎</td><td>多伦多电影节</td></tr></tbody></table></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#条件选择</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.评分.max()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].max()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.评分.idxmax()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.评分.min()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;评分&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].min()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.评分.idxmin()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><pre><code>9.9

9.9

1110

2.0

2.0

29100
</code></pre><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.产地</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;美国&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[df.产地</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中国大陆&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df[df.产地</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中国大陆&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[(df.产地</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;美国&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df.产地</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中国大陆&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df.评分</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)].head()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><pre><code>0         True
1         True
2        False
3         True
4        False
         ...
38733    False
38734     True
38735    False
38736    False
38737    False
Name: 产地, Length: 38738, dtype: bool
</code></pre><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>4</th><td>霸王别姬</td><td>478523.0</td><td>剧情/爱情/同性</td><td>中国大陆</td><td>1993-01-01 00:00:00</td><td>171</td><td>1993</td><td>9.4</td><td>香港</td></tr><tr><th>21</th><td>大闹天宫</td><td>74881.0</td><td>动画/奇幻</td><td>中国大陆</td><td>1905-05-14 00:00:00</td><td>114</td><td>1961</td><td>9.2</td><td>上集</td></tr><tr><th>29</th><td>穹顶之下</td><td>51113.0</td><td>纪录片</td><td>中国大陆</td><td>2015-02-28 00:00:00</td><td>104</td><td>2015</td><td>9.2</td><td>中国大陆</td></tr><tr><th>38</th><td>茶馆</td><td>10678.0</td><td>剧情/历史</td><td>中国大陆</td><td>1905-06-04 00:00:00</td><td>118</td><td>1982</td><td>9.2</td><td>美国</td></tr><tr><th>45</th><td>山水情</td><td>10781.0</td><td>动画/短片</td><td>中国大陆</td><td>1905-06-10 00:00:00</td><td>19</td><td>1988</td><td>9.2</td><td>美国</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>38727</th><td>T省的八四、八五</td><td>380.0</td><td>剧情</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>94</td><td>1986</td><td>8.7</td><td>美国</td></tr><tr><th>38729</th><td>失踪的女中学生</td><td>101.0</td><td>儿童</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>102</td><td>1986</td><td>7.4</td><td>美国</td></tr><tr><th>38731</th><td>血战台儿庄</td><td>2908.0</td><td>战争</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>120</td><td>1986</td><td>8.1</td><td>美国</td></tr><tr><th>38735</th><td>血溅画屏</td><td>95.0</td><td>剧情/悬疑/犯罪/武侠/古装</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>91</td><td>1986</td><td>7.1</td><td>美国</td></tr><tr><th>38736</th><td>魔窟中的幻想</td><td>51.0</td><td>惊悚/恐怖/儿童</td><td>中国大陆</td><td>1905-06-08 00:00:00</td><td>78</td><td>1986</td><td>8.0</td><td>美国</td></tr></tbody></table><p>3803 rows × 9 columns</p></div><pre><code>3803
</code></pre><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>名字</th><th>投票人数</th><th>类型</th><th>产地</th><th>上映时间</th><th>时长</th><th>年代</th><th>评分</th><th>首映地点</th></tr></thead><tbody><tr><th>0</th><td>肖申克的救赎</td><td>692795.0</td><td>剧情/犯罪</td><td>美国</td><td>1994-09-10 00:00:00</td><td>142</td><td>1994</td><td>9.6</td><td>多伦多电影节</td></tr><tr><th>1</th><td>控方证人</td><td>42995.0</td><td>剧情/悬疑/犯罪</td><td>美国</td><td>1957-12-17 00:00:00</td><td>116</td><td>1957</td><td>9.5</td><td>美国</td></tr><tr><th>3</th><td>阿甘正传</td><td>580897.0</td><td>剧情/爱情</td><td>美国</td><td>1994-06-23 00:00:00</td><td>142</td><td>1994</td><td>9.4</td><td>洛杉矶首映</td></tr><tr><th>4</th><td>霸王别姬</td><td>478523.0</td><td>剧情/爱情/同性</td><td>中国大陆</td><td>1993-01-01 00:00:00</td><td>171</td><td>1993</td><td>9.4</td><td>香港</td></tr><tr><th>5</th><td>泰坦尼克号</td><td>157074.0</td><td>剧情/爱情/灾难</td><td>美国</td><td>2012-04-10 00:00:00</td><td>194</td><td>2012</td><td>9.4</td><td>中国大陆</td></tr></tbody></table>`,95),d=[h];function l(p,e,k,r,E,g){return i(),t("div",null,d)}const c=s(n,[["render",l]]);export{b as __pageData,c as default};
